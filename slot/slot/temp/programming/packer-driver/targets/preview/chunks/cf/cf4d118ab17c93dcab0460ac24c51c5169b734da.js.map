{"version":3,"sources":["file:///C:/Cocos/slot/assets/scripts/controllers/GameController.ts"],"names":["_decorator","Component","Layout","Node","Animation","Label","MusicController","GameService","FunctionUtils","gameService","functionUtils","ccclass","property","GameController","type","layer1Pics","layer2Pics","layer3Pics","bingoTime","throttledStartGame","start","throttle","startGame","bind","initGame","layout1","layout2","layout3","audioManager","playRollingMusic","removeChilds","resetLayout","rollPicture","Promise","all","tweenPictures","then","checkResult","bingoNode","active","playBingoMusic","getChildByName","getComponent","string","toString","goStart","ani","handleBar1","play"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Layout, Node, Prefab, resources, tween, Vec3, Animation, Label } from 'cc';\r\nimport { MusicController } from './MusicController';\r\nimport { GameService } from '../services/GameService';\r\nimport { FunctionUtils } from '../../utils/FunctionUtils';\r\nconst gameService = new GameService()\r\nconst functionUtils = new FunctionUtils()\r\n\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameController')\r\nexport class GameController extends Component {\r\n\r\n    @property({type:Layout})\r\n    private layout1:Layout = null\r\n\r\n    @property({type:Layout})\r\n    private layout2:Layout = null\r\n\r\n    @property({type:Layout})\r\n    private layout3:Layout = null\r\n\r\n    @property({type:Node})\r\n    private handleBar1:Node = null\r\n\r\n    @property({type:MusicController})\r\n    private audioManager:MusicController = null \r\n\r\n    @property({type:Node})\r\n    private bingoNode:Node = null\r\n\r\n    private layer1Pics:Node[] = []\r\n\r\n    private layer2Pics:Node[] = []\r\n\r\n    private layer3Pics:Node[] = []\r\n\r\n    private bingoTime = 0\r\n\r\n    private throttledStartGame:() => void\r\n\r\n\r\n\r\n\r\n    start() {\r\n        this.throttledStartGame = functionUtils.throttle(this.startGame.bind(this), 4000)\r\n\r\n        gameService.initGame(this.layout1, this.layout2, this.layout3, this.layer1Pics, this.layer2Pics, this.layer3Pics)\r\n    }\r\n\r\n    async startGame(){\r\n        this.audioManager.playRollingMusic()\r\n        gameService.removeChilds(this.layout1, this.layer1Pics)\r\n        gameService.removeChilds(this.layout2, this.layer2Pics)\r\n        gameService.removeChilds(this.layout3, this.layer3Pics)\r\n\r\n        gameService.resetLayout(this.layout1)\r\n        gameService.resetLayout(this.layout2)\r\n        gameService.resetLayout(this.layout3)\r\n        \r\n\r\n        await gameService.rollPicture(this.layout1, this.layer1Pics)\r\n        await gameService.rollPicture(this.layout2, this.layer2Pics)\r\n        await gameService.rollPicture(this.layout3, this.layer3Pics)\r\n        \r\n        Promise.all([\r\n\r\n            gameService.tweenPictures(this.layout1),\r\n            gameService.tweenPictures(this.layout2),\r\n            gameService.tweenPictures(this.layout3)\r\n\r\n        ]).then(()=>{\r\n\r\n            if(gameService.checkResult(this.layer1Pics, this.layer2Pics, this.layer3Pics)){\r\n                this.bingoNode.active = true\r\n                this.audioManager.playBingoMusic()\r\n                this.bingoNode.getChildByName('Score').getComponent(Label).string = (++this.bingoTime*100).toString()\r\n            }\r\n\r\n        })\r\n\r\n    }\r\n\r\n\r\n    goStart(){\r\n        let ani = this.handleBar1.getComponent(Animation)\r\n        ani.play('handelbar')\r\n        this.throttledStartGame()\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n"]}